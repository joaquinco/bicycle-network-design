#!/bin/sh

# Take models from exact foleder. To override the model loaded
# specify the name without extension in the BCNETWORK_MODEL_NAME variable
#

set -e

if [ -z "$1" -o -z "$2" ]; then
  echo "Usage:"
  echo "cbc <data_file> <output_file>"
  exit 1
fi

model_name=${BCNETWORK_MODEL_NAME:-single_level}
model_file=exact/$model_name.mod

if [ ! -f $model_file ]; then
  echo "Model file $model_file does not exist" >&2
  exit 2
fi

# Need to build cbc locally
# coinbrew fetch Cbc@master && coinbrew build -j4 Cbc --with-glpk --with-pthread
#
cbc $model_file%$1 -thread 10 -solve -gsolu $2
